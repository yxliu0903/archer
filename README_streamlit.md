# Delta Net 树结构可视化 - Streamlit版本

这是一个基于Streamlit的交互式树形结构可视化工具，用于展示Delta Net模型的层次结构和性能数据。

## 功能特点

- 🌳 **层次化树形图**: 清晰展示模型的父子关系
- 📊 **交互式数据表**: 浏览所有节点的详细信息
- 🔍 **节点详情查看**: 深入了解单个节点的性能数据
- 🎨 **颜色编码**: 根据评分高低使用不同颜色
- 📈 **实时数据更新**: 从服务器获取最新数据
- 💾 **数据缓存**: 提高加载速度

## 安装依赖

```bash
pip install -r requirements.txt
```

或者手动安装：

```bash
pip install streamlit plotly networkx requests pandas
```

## 启动应用

### 方法1：使用启动脚本（推荐）

```bash
./start_streamlit.sh
```

### 方法2：直接运行

```bash
streamlit run streamlit_app.py
```

## 访问应用

启动后，在浏览器中访问：
```
http://localhost:8501
```

## 界面说明

### 主要功能区

1. **控制面板**（左侧边栏）
   - 🔄 更新数据：从服务器获取最新数据
   - 📈 系统状态：显示缓存和连接状态
   - 💡 使用帮助：功能说明

2. **统计信息**（顶部）
   - 总节点数
   - 变体数量
   - 服务器记录数

3. **主要标签页**
   - 🌳 **树形图**：交互式层次结构可视化
   - 📊 **数据表**：表格形式查看所有数据
   - 🔍 **节点详情**：单个节点详细信息

### 树形图功能

- **节点大小**：根节点较大，子节点较小
- **颜色编码**：
  - 红色：评分较低
  - 黄色：评分中等
  - 蓝色：评分较高
- **悬停提示**：显示节点详细信息
- **层级显示**：根节点在顶部，向下展开

### 数据表功能

- **完整信息**：显示所有节点的关键数据
- **可排序**：点击列标题排序
- **可搜索**：使用搜索框快速查找
- **导出功能**：下载CSV格式数据

## 数据说明

### 节点信息包含：
- **节点ID**：唯一标识符
- **名称**：节点名称
- **父节点**：父节点ID
- **训练结果**：训练损失值
- **测试结果**：测试准确率
- **评分**：综合评分
- **描述**：节点描述信息

### 数据来源
- API服务器：`http://45.78.231.212:8001`
- 缓存文件：`cache.json`

## 配置选项

### 布局参数
- `y_spacing = 200`：层级间垂直间距
- `x_spacing = 200`：节点间水平间距
- 动态间距调整：节点过多时自动增加间距

### 视觉参数
- 根节点大小：40px
- 子节点大小：25px
- 连接线宽度：2px
- 图表高度：800px

## 故障排除

### 常见问题

1. **无法连接服务器**
   - 检查网络连接
   - 确认API服务器地址正确
   - 查看控制面板的连接状态

2. **数据显示异常**
   - 点击"更新数据"按钮
   - 检查缓存文件是否损坏
   - 重启应用

3. **图表显示问题**
   - 刷新浏览器页面
   - 检查浏览器控制台错误
   - 确认Plotly版本兼容性

### 性能优化

- 使用缓存机制减少API调用
- 大量节点时自动调整布局
- 异步加载数据避免阻塞

## 对比HTML版本

| 功能 | HTML版本 | Streamlit版本 |
|------|----------|---------------|
| 部署方式 | 静态文件 | Python应用 |
| 交互性 | 基础交互 | 丰富交互 |
| 数据处理 | 客户端JS | 服务端Python |
| 界面美观 | 自定义CSS | 现代化UI |
| 扩展性 | 有限 | 高度可扩展 |

## 技术栈

- **前端**：Streamlit
- **图表**：Plotly
- **布局**：NetworkX
- **数据处理**：Pandas
- **HTTP请求**：Requests

## 开发说明

### 文件结构
```
tree_visual/
├── streamlit_app.py      # 主应用文件
├── start_streamlit.sh    # 启动脚本
├── requirements.txt      # 依赖列表
├── cache.json           # 数据缓存
└── README_streamlit.md  # 使用说明
```

### 主要函数
- `load_cache_data()`: 加载缓存数据
- `build_tree_structure()`: 构建树形结构
- `calculate_hierarchical_layout()`: 计算层次布局
- `create_tree_visualization()`: 创建可视化图表

## 更新日志

### v1.0.0
- 初始版本发布
- 基础树形可视化功能
- 数据缓存机制
- 交互式界面

## 许可证

本项目遵循MIT许可证。 